<header>
    <h1>Client Update</h1>
</header>
<nav>
    <button type="button">Get Next Alt ID</button>
    <button type="button">Add Client</button>
    <button type="button">Delete Client</button>
    <button type="button" onclick="location.href='@Url.Action("Index", "Home")'">Close</button>
    <button type="button"> View Services for this Client </button>
</nav>
@{
    eciWEB2016.Models.Client currentClient = new eciWEB2016.Models.Client();

    if (Session["client"] != null)
    {
        currentClient = (eciWEB2016.Models.Client)Session["client"];
    }
}
<div class="subnav">
    <div class="column">
        <ul>
            <li>
                <label>Alt ID:</label>
            </li>
            <li>
                <label>Find Client:</label>
                <input type="text" id="clientSearch" placeholder="Search client list..." />
            </li>
        </ul>
        <ul>
            <li>
                <button type="button">Close if No Records</button>
            </li>
            <li>
                <button type="button">Remove Filter</button>
            </li>
        </ul>
    </div>
</div>
<div class="main" id="main">
    @Html.Partial("Client_Partial")
</div>
@section JavaScript
{
    <script>
        // Selects the appropriate sex from the sex dropdown table based on result of the current client in session.
        $(function() {
            $('select[name^="sex"] option[value="@currentClient.sex"]').attr("selected", "selected");
        });
    </script>
    <script>
        $(function () {

            var clientListData = [];

            // Returns a list of clients which will be added to the combobox.
            $.ajax({
                type: "GET",
                contentType: "application/json; charset=utf-8",
                url: "GetAjaxClientList/Client",
                dataType: "json",
                success: function (data) {
                    var result;
                    $.each(data, function (index, value) {
                        clientListData.push(
                            {"label":
                            value.lastName + ', ' + value.firstName,
                            "value":
                            value.lastName + ', ' + value.firstName,
                            "clientId":
                            value.clientID
                            });
                    });
                }
            });

            // ClientList autocomplete jquery code.
            $('#clientSearch').autocomplete({
                // This is where the Ajax call goes to pull the client list.
                source: clientListData,

                // Calls the controller to store the new client in Session. Refreshes the page with new session info input.
                change: function (event, ui) {
                    var selectedClient = parseInt(ui.item.clientId);
                    var url = '@Url.Action("GetAjaxClient", "Client")';
                    $.post(url, {
                        identifier: selectedClient
                    },
                    function (data){
                        $('#main').html(data);
                    }
                    );
                }
            });
        })
    </script>
}
